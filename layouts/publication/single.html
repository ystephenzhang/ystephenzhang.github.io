{{ define "main" }}
<article class="article publication-page">
  <div class="article-container">
    <header class="article-header">
      <h1>{{ .Title }}</h1>

      {{ with .Params.publication }}
        <p class="article-subtitle">{{ . | markdownify }}</p>
      {{ end }}

      <div class="article-metadata">
        {{ with .Params.authors }}
          <div class="pub-authors"><strong>Authors:</strong> {{ delimit . ", " }}</div>
        {{ end }}
        <div class="pub-meta-line">
          {{ with .Date }}
            <span class="pub-meta-item">{{ . | time.Format "Jan 2, 2006" }}</span>
          {{ end }}
          {{ with .Params.publication_types }}
            <span class="pub-meta-item">
              {{ range $i, $t := . }}{{ if $i }}, {{ end }}{{ humanize $t }}{{ end }}
            </span>
          {{ end }}
        </div>
      </div>

      {{ $pdf := .Resources.GetMatch "*.pdf" }}
      {{ $bib := .Resources.GetMatch "*.bib" }}
      {{ if or $pdf (or $bib .Params.links) }}
        <div class="article-links">
          {{ with $pdf }}<a class="btn btn-primary btn-sm" href="{{ .RelPermalink }}">PDF</a>{{ end }}
          {{ with $bib }}<a class="btn btn-outline btn-sm" href="{{ .RelPermalink }}">BibTeX</a>{{ end }}
          {{ range .Params.links }}
            <a class="btn btn-outline btn-sm" href="{{ .url }}">{{ default (title .type) .text }}</a>
          {{ end }}
        </div>
      {{ end }}
    </header>

    {{ with .Resources.GetMatch "featured*" }}
      <figure class="article-cover">
        <img src="{{ .RelPermalink }}" alt="{{ $.Title }}">
      </figure>
    {{ end }}

    <div class="article-style publication-body">
      {{ $body := strings.TrimSpace .Content }}
      {{ if $body }}
        {{ .Content }}
      {{ else if .Params.abstract }}
        <h2>Abstract</h2>
        <p>{{ .Params.abstract | markdownify }}</p>
      {{ end }}
    </div>

    <div class="publication-extra">
      <ul class="pub-meta-list">
        {{ with .Params.publication }}<li><strong>Publication:</strong> {{ . | markdownify }}</li>{{ end }}
        {{ with .Params.publication_short }}<li><strong>Venue:</strong> {{ . | markdownify }}</li>{{ end }}
        {{ with .Params.hugoblox.ids.doi }}<li><strong>DOI:</strong> {{ . }}</li>{{ end }}
        {{ with .Params.tags }}<li><strong>Tags:</strong> {{ delimit . ", " }}</li>{{ end }}
      </ul>
    </div>
  </div>
</article>
{{ end }}
